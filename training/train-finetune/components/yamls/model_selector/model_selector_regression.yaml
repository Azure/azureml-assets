$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: azureml_regression_modelselection
version: 0.0.1
type: command

is_deterministic: True

display_name: ModelSelection for Regression
description: Component to download model from cdn basis the provided model name or path

environment: azureml:azml-train-finetune-ptca-aifx-stable-ubuntu2004-cu113-py38-torch1110:0.0.1

code: ../../scripts/model_selector

inputs:
  # Model and task name
  model_id:
    type: string
    enum:
      - "microsoft/deberta-base"
      - "microsoft/deberta-large"
      - "microsoft/deberta-xlarge"
      - "microsoft/deberta-base-mnli"
      - "microsoft/deberta-large-mnli"
      - "microsoft/deberta-xlarge-mnli"
      - "distilbert-base-uncased"
      - "distilbert-base-uncased-distilled-squad"
      - "distilbert-base-cased"
      - "distilbert-base-cased-distilled-squad"
      - "roberta-base"
      - "roberta-large"
      - "roberta-large-mnli"
      - "roberta-base-openai-detector"
      - "roberta-large-openai-detector"
      - "bert-base-uncased"
      - "bert-large-uncased"
      - "bert-base-cased"
      - "bert-large-cased"
      - "gpt2"
      - "gpt2-medium"
      - "gpt2-large"
      - "gpt2-xl"
      - "tnlrv5-base-cased"
      - "tnlrv5-large-cased"
      - "tnlrv5-xl-cased"
      - "tnlrv5-xxl-cased"
      - "tnlrv4-base-cased"
      - "tnlrv4-large-cased"
      - "tnlrv4-small-cased"
      - "tnlrv4-xsmall-cased"
      - "tnlrv4-tiny-cased"
    default: bert-base-uncased
    description: model id used to load model checkpoint.

  huggingface_id:
    type: string
    description: Input HuggingFace model id takes priority over model_id.
    optional: true

  # Continual-Finetuning model path
  continual_finetuning_model_path:
    type: uri_folder
    optional: true
    description: Input folder path containing model for further finetuning. Proper model id must be passed.

outputs:
  output_dir:
    type: uri_folder
    description: folder to store model metadata

command: >-
  python model_selector.py --model_name_or_path ${{inputs.model_id}} $[[--huggingface_id ${{inputs.huggingface_id}}]] $[[--continual_finetuning_model_path ${{inputs.continual_finetuning_model_path}}]] --output_dir ${{outputs.output_dir}}

