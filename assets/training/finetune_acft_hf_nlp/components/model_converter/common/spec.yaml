$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: ft_nlp_model_converter
version: 0.0.21
type: command

is_deterministic: True

display_name: Common Model Converter
description: Component to convert the finetune job output to pytorch and mlflow model

environment: azureml://registries/azureml/environments/acft-hf-nlp-gpu/versions/25

code: ../../../src/model_converter

inputs:
  model_path:
    type: uri_folder
    optional: false
    description: Pytorch model asset path. Pass the finetune job pytorch model output.

  converted_model:
    type: mlflow_model
    optional: true
    description: Exisiting converted MlFlow path. Pass the finetune job mlflow model output.
  
outputs:
  output_dir:
    type: mlflow_model
    description: output folder containing _best_ finetuned model in mlflow format.

command: >-
  python model_converter.py --model_path '${{inputs.model_path}}' $[[--converted_model '${{inputs.converted_model}}']] --output_dir '${{outputs.output_dir}}'
