# **Model Details**

Zephyr is a series of language models that are trained to act as helpful assistants. Zephyr-7B-Î± is the first model in the series, and is a fine-tuned version of mistralai/Mistral-7B-v0.1 that was trained on on a mix of publicly available, synthetic datasets using Direct Preference Optimization (DPO). We found that removing the in-built alignment of these datasets boosted performance on MT Bench and made the model more helpful. However, this means that model is likely to generate problematic text when prompted to do so.

# Model description
Model type: A 7B parameter GPT-like model fine-tuned on a mix of publicly available, synthetic datasets.

Language(s) (NLP): Primarily English

License: MIT

Finetuned from model: mistralai/Mistral-7B-v0.1

# Model Sources
Repository: https://github.com/huggingface/alignment-handbook
Demo: https://huggingface.co/spaces/HuggingFaceH4/zephyr-chat

# Intended uses & limitations
The model was initially fine-tuned on a variant of the UltraChat dataset, which contains a diverse range of synthetic dialogues generated by ChatGPT. We then further aligned the model with ðŸ¤— TRL's DPOTrainer on the openbmb/UltraFeedback dataset, which contain 64k prompts and model completions that are ranked by GPT-4. As a result, the model can be used for chat and you can check out our demo to test its capabilities.

# Bias, Risks, and Limitations
Zephyr-7B-Î± has not been aligned to human preferences with techniques like RLHF or deployed with in-the-loop filtering of responses like ChatGPT, so the model can produce problematic outputs (especially when prompted to do so). It is also unknown what the size and composition of the corpus was used to train the base model (mistralai/Mistral-7B-v0.1), however it is likely to have included a mix of Web data and technical sources like books and code. See the Falcon 180B model card for an example of this.

# Training and evaluation data
## Training hyperparameters
The following hyperparameters were used during training:
learning_rate: 5e-07
train_batch_size: 2
eval_batch_size: 4
seed: 42
distributed_type: multi-GPU
num_devices: 16
total_train_batch_size: 32
total_eval_batch_size: 64
optimizer: Adam with betas=(0.9,0.999) and epsilon=1e-08
lr_scheduler_type: linear
lr_scheduler_warmup_ratio: 0.1
num_epochs: 1

# Framework versions
Transformers 4.34.0
Pytorch 2.0.1+cu118
Datasets 2.12.0
Tokenizers 0.14.0

> The above summary was generated using ChatGPT. Review the <a href="https://huggingface.co/HuggingFaceH4/zephyr-7b-alpha" target="_blank">original model card</a> to understand the data used to train the model, evaluation metrics, license, intended uses, limitations and bias before using the model.

# Inference samples

Inference type|Python sample (Notebook)
|--|--|
Real time|[sdk-example.ipynb](https://aka.ms/sdk-notebook-examples)
Real time|[text-generation-online-endpoint.ipynb](https://aka.ms/text-generation-online-endpoint-oss)

### Model Evaluation

Task| Use case| Dataset| Python sample (Notebook)| CLI with YAML
|--|--|--|--|--|
Token Classification | Token Classification | <a href="https://huggingface.co/datasets/conll2003" target="_blank">CoNLL 2003</a> | <a href="https://aka.ms/azureml-eval-sdk-token-classification" target="_blank">evaluate-model-token-classification.ipynb</a> | <a href="https://aka.ms/azureml-eval-cli-token-classification" target="_blank">evaluate-model-token-classification.yml</a>

# Sample inputs and outputs

### Sample input
```json
{
  "input_data": {
    "input_string": [
      "the meaning of life is"
    ],
    "params": {
      "top_p": 0.9,
      "temperature": 0.2,
      "max_new_tokens": 100,
      "do_sample": true,
      "return_full_text": true
    }
  }
}
```

### Sample output
```json
[
  {
    "0": "the meaning of life is to find happiness and fulfill"
  }
]
```
